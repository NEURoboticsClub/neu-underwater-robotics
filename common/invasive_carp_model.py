import matplotlib.pyplot as plt
import matplotlib.animation as animation
from PIL import Image

def animate_river_with_carp(image_path, river_sections, years, sections_with_carp):
    img = Image.open(image_path)

    fig, ax = plt.subplots()

    ax.imshow(img)
    ax.axis('off')

    river_patches = []

    year_text = ax.text(275, 825, '', fontsize=12, fontweight='bold', color='black', ha='left', va='top')

    def init():
        for patch in river_patches:
            patch.remove()
        river_patches.clear()
        year_text.set_text('')
        return []

    def update(frame):
        for patch in river_patches:
            patch.remove()
        river_patches.clear()

        for section in sections_with_carp[frame]:
            scaled_section = [
                (x * 1.75 - 20, y * 1.75 - 10)
                for x, y in river_sections[section]
            ]
            patch = plt.Polygon(scaled_section, closed=False, edgecolor='black', facecolor='none', lw=3)
            ax.add_patch(patch)
            river_patches.append(patch)

        year_text.set_text(f'Year: {years[frame]}')

        return river_patches + [year_text]

    anima = animation.FuncAnimation(
        fig, update, frames=len(years), init_func=init, blit=True, interval=1000, repeat=False
    )

    plt.legend()
    plt.show()

if __name__ == "__main__":
    image_path = 'invasive-carp-map.png'

    river_sections = [
        [
            (141, 462),
            (140, 462),
            (140, 463),
            (139, 463),
            (138, 463),
            (137, 464),
            (136, 464),
            (136, 465),
            (135, 463),
            (134, 462),
            (133, 461),
            (131, 459),
            (131, 458),
            (130, 457),
            (130, 456),
            (130, 454),
            (130, 453),
            (130, 452),
            (130, 451),
            (130, 450),
            (130, 448),
            (130, 447),
            (130, 446),
            (130, 442),
            (130, 441),
            (130, 439),
            (130, 438),
            (131, 437),
            (131, 435),
            (131, 433),
            (131, 431),
            (131, 430),
            (131, 427),
            (131, 424),
            (131, 423),
            (131, 422),
            (131, 421),
            (131, 420),
            (131, 418),
            (131, 416),
            (131, 415),
            (131, 413),
            (131, 412),
            (131, 411),
            (131, 410),
            (131, 408),
            (131, 406),
            (131, 405),
            (131, 404),
            (131, 403),
            (131, 402),
            (131, 401),
            (130, 400),
            (130, 399),
            (130, 398),
            (130, 397),
            (130, 396),
            (129, 395),
            (129, 393),
            (128, 392),
            (128, 391),
            (128, 390),
            (128, 388),
            (128, 386),
            (128, 384),
            (128, 382),
            (128, 381),
            (128, 379),
            (128, 378),
            (128, 377),
            (129, 376),
            (130, 375),
            (130, 374),
            (131, 373),
            (131, 372),
            (131, 371),
            (132, 370),
            (133, 369),
            (133, 368),
            (134, 367),
            (135, 366),
            (135, 365),
            (136, 364),
            (137, 362),
            (138, 361),
            (138, 360),
            (139, 359),
            (140, 358),
            (141, 357),
            (142, 357),
            (143, 357),
            (144, 356),
            (146, 356),
            (146, 355),
            (147, 354),
            (148, 354),
            (148, 353),
            (148, 352),
            (148, 351),
            (148, 350)
        ],
        [
            (149, 348),
            (149, 347),
            (149, 346),
            (149, 345),
            (150, 345),
            (151, 344),
            (151, 343),
            (152, 342),
            (152, 341),
            (153, 341),
            (155, 342),
            (156, 342),
            (157, 342),
            (158, 342),
            (159, 342),
            (160, 342),
            (161, 342),
            (162, 342),
            (163, 342),
            (164, 342),
            (165, 341),
            (165, 340),
            (165, 339),
            (166, 339),
            (166, 338),
            (166, 337),
            (167, 337),
            (167, 336),
            (168, 336),
            (168, 335),
            (168, 334),
            (169, 334),
            (169, 333),
            (170, 332),
            (170, 331),
            (171, 331),
            (172, 331),
            (173, 330),
            (174, 329),
            (175, 329),
            (175, 328),
            (176, 328),
            (176, 327),
            (177, 327),
            (177, 326),
            (177, 325),
            (177, 324),
            (177, 323),
            (177, 322),
            (178, 322),
            (178, 321),
            (179, 320),
            (180, 320),
            (180, 319),
            (181, 319),
            (181, 318),
            (181, 317),
            (181, 316),
            (182, 316),
            (183, 316),
            (185, 315),
            (186, 315),
            (186, 314),
            (187, 314),
            (188, 313),
            (189, 313),
            (190, 313),
            (190, 312),
            (190, 311),
            (191, 310),
            (192, 309),
            (193, 309),
            (193, 308),
            (193, 307),
            (193, 306),
            (194, 306),
            (194, 305),
            (195, 305),
            (195, 304),
            (196, 304),
            (196, 303),
            (197, 303),
            (198, 303),
            (198, 302),
            (199, 302),
            (199, 301),
            (200, 301),
            (200, 300),
            (201, 300),
            (202, 300),
            (203, 300),
            (204, 300),
            (205, 300),
            (205, 299)
        ],
        [
            (208, 299),
            (209, 297),
            (209, 296),
            (210, 295),
            (211, 294),
            (211, 293),
            (212, 293),
            (213, 292),
            (214, 291),
            (215, 290),
            (216, 289),
            (217, 287),
            (217, 285),
            (217, 283),
            (217, 282),
            (217, 280),
            (217, 277),
            (218, 276),
            (219, 275),
            (219, 274),
            (220, 274),
            (220, 273),
            (220, 272),
            (220, 271),
            (220, 270),
            (220, 269),
            (221, 269),
            (222, 268),
            (223, 267),
            (224, 266),
            (224, 265),
            (225, 265),
            (225, 264),
            (225, 263),
            (225, 262),
            (226, 262),
            (227, 261),
            (228, 260),
            (228, 259),
            (229, 257),
            (229, 256),
            (229, 255),
            (230, 253),
            (230, 252),
            (231, 251),
            (232, 249),
            (232, 248),
            (232, 247),
            (233, 246),
            (233, 245),
            (233, 244),
            (234, 242),
            (235, 241),
            (235, 240),
            (236, 240),
            (236, 239),
            (236, 238),
            (236, 237),
            (236, 236),
            (236, 235),
            (236, 234),
            (236, 233),
            (236, 232),
            (236, 231),
            (236, 230),
            (235, 230),
            (235, 229),
            (235, 228),
            (234, 227),
            (234, 226),
            (234, 225),
            (234, 223),
            (236, 223),
            (237, 223),
            (238, 222),
            (239, 222),
            (240, 222),
            (241, 221),
            (242, 220),
            (243, 220),
            (244, 220),
            (245, 220),
            (246, 220),
            (247, 220),
            (248, 220),
            (249, 220),
            (250, 220),
            (251, 219),
            (252, 219),
            (253, 219),
            (254, 219),
            (255, 219),
            (256, 219),
            (257, 219),
            (258, 220),
            (259, 220),
            (260, 220),
            (259, 220)
        ],
        [
            (261, 220),
            (262, 220),
            (263, 220),
            (264, 220),
            (265, 220),
            (266, 220),
            (267, 220),
            (268, 219),
            (269, 219),
            (270, 218),
            (271, 218),
            (272, 218),
            (273, 218),
            (274, 218),
            (275, 218),
            (276, 218),
            (277, 218),
            (278, 218),
            (279, 218),
            (279, 219),
            (280, 219),
            (281, 219),
            (282, 219),
            (282, 220),
            (283, 221),
            (283, 222),
            (284, 222),
            (284, 223),
            (285, 223),
            (286, 223),
            (287, 223),
            (288, 223),
            (289, 223),
            (290, 223),
            (291, 222),
            (292, 221),
            (293, 221),
            (295, 221),
            (298, 221),
            (299, 221),
            (300, 221),
            (301, 221),
            (302, 221),
            (303, 221),
            (303, 220),
            (304, 220),
            (305, 219),
            (306, 218),
            (308, 218),
            (309, 217),
            (310, 216),
            (312, 216),
            (313, 215),
            (313, 214),
            (314, 214),
            (316, 214),
            (317, 214),
            (318, 214),
            (319, 214),
            (320, 214),
            (321, 214),
            (321, 213),
            (322, 213),
            (323, 212),
            (324, 211),
            (325, 210),
            (325, 209),
            (326, 209),
            (327, 208),
            (328, 208),
            (328, 207),
            (329, 207),
            (330, 206),
            (331, 206),
            (332, 206),
            (332, 205),
            (332, 204),
            (333, 204),
            (334, 204),
            (334, 203),
            (334, 202),
            (335, 201),
            (335, 200),
            (335, 199),
            (336, 199),
            (336, 198),
            (336, 197),
            (336, 196),
            (336, 195),
            (336, 194),
            (336, 193),
            (336, 192),
            (336, 191),
            (336, 190),
            (336, 189),
            (336, 188),
            (336, 187),
            (336, 186),
            (336, 184),
            (336, 183),
            (336, 182),
            (336, 181),
            (336, 180),
            (337, 180),
            (337, 179),
            (338, 179),
            (339, 179),
            (340, 179),
            (341, 179),
            (342, 179),
            (343, 178),
            (344, 178),
            (345, 177),
            (346, 176),
            (347, 176),
            (348, 176),
            (349, 176),
            (349, 175),
            (350, 175),
            (351, 175),
            (352, 174),
            (353, 174),
            (353, 173),
            (354, 173),
            (354, 172),
            (355, 172),
            (355, 171),
            (356, 171),
            (356, 170),
            (357, 170),
            (358, 170),
            (359, 170),
            (360, 169),
            (361, 169),
            (361, 168),
            (362, 168),
            (363, 168),
            (363, 167),
            (363, 166),
            (364, 166),
            (364, 165),
            (365, 165),
            (366, 164),
            (366, 163),
            (367, 162),
            (368, 162),
            (369, 162),
            (370, 162),
            (371, 162),
            (372, 162),
            (372, 161),
            (373, 161)
        ],
        [
            (360, 100),
            (360, 101),
            (360, 102),
            (359, 103),
            (359, 104),
            (358, 105),
            (357, 105),
            (357, 106),
            (356, 106),
            (356, 107),
            (356, 108),
            (356, 109),
            (356, 110),
            (356, 111),
            (356, 112),
            (356, 113),
            (356, 114),
            (356, 115),
            (356, 116),
            (356, 117),
            (356, 118),
            (356, 119),
            (356, 120),
            (357, 120),
            (357, 121),
            (357, 122),
            (358, 122),
            (358, 123),
            (358, 124),
            (358, 125),
            (358, 126),
            (358, 127),
            (358, 128),
            (358, 129),
            (358, 130),
            (358, 131),
            (359, 131),
            (359, 132),
            (360, 132),
            (361, 132),
            (361, 133),
            (364, 134),
            (364, 135),
            (365, 135),
            (366, 136),
            (367, 138),
            (367, 139),
            (368, 141),
            (369, 141),
            (369, 142),
            (370, 142),
            (370, 143),
            (370, 144),
            (371, 144),
            (371, 145),
            (372, 145),
            (372, 146),
            (372, 147),
            (373, 147),
            (373, 148),
            (373, 149),
            (373, 150),
            (373, 151),
            (372, 152),
            (372, 153),
            (371, 154),
            (371, 155),
            (371, 156),
            (371, 157),
            (371, 158),
            (371, 159),
            (371, 160),
            (371, 161),
            (371, 162),
            (372, 162),
            (373, 163),
            (373, 164),
            (374, 164),
            (374, 165),
            (374, 166),
            (375, 167),
            (376, 168),
            (376, 169),
            (377, 171),
            (377, 172),
            (378, 172),
            (378, 173),
            (378, 174),
            (379, 175),
            (380, 175),
            (380, 176),
            (381, 177),
            (381, 178),
            (382, 178),
            (382, 179),
            (382, 180),
            (383, 180),
            (384, 181),
            (385, 181),
            (386, 181),
            (387, 181),
            (388, 181),
            (388, 182),
            (389, 182),
            (389, 183),
            (390, 183),
            (391, 183),
            (391, 184),
            (392, 185),
            (393, 186),
            (394, 186),
            (395, 186),
            (396, 186),
            (397, 187),
            (398, 188),
            (399, 188),
            (400, 188),
            (401, 188),
            (402, 188),
            (403, 188),
            (404, 188),
            (405, 188),
            (406, 188),
            (407, 188),
            (408, 188),
            (409, 188),
            (410, 188),
            (411, 187),
            (412, 187),
            (412, 186),
            (413, 186),
            (413, 185),
            (414, 185),
            (415, 184),
            (416, 184),
            (417, 184),
            (418, 184),
            (419, 184),
            (420, 184),
            (421, 184),
            (422, 184),
            (422, 183),
            (423, 183),
            (423, 182),
            (424, 182),
            (425, 182),
            (426, 181),
            (427, 180),
            (428, 180),
            (429, 179),
            (430, 179),
            (432, 179),
            (434, 178),
            (435, 177),
            (435, 176),
            (436, 176),
            (436, 175),
            (437, 175),
            (439, 174),
            (440, 173),
            (441, 172),
            (441, 171),
            (442, 171),
            (442, 170),
            (442, 169),
            (442, 168),
            (442, 167),
            (443, 167),
            (443, 166),
            (443, 165),
            (444, 165),
            (444, 164),
            (444, 163),
            (445, 163),
            (445, 162),
            (445, 161),
            (446, 160),
            (446, 159),
            (446, 158),
            (447, 158),
            (447, 157),
            (448, 156),
            (448, 155),
            (448, 154),
            (448, 153),
            (448, 152),
            (448, 151),
            (449, 150),
            (449, 149),
            (449, 148)
        ]
    ]

    years = range(2016, 2026)

    sections_with_carp = [
        [],
        [0],
        [0],
        [0],
        [0, 1, 2],
        [0, 1, 2],
        [0, 1, 2],
        [0, 1, 2, 3, 4],
        [0, 1, 2, 3, 4],
        [0, 1, 2, 3, 4],
    ]

    animate_river_with_carp(image_path, river_sections, years, sections_with_carp)
